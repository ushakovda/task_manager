{% extends "base.html" %}

{% block header %}
    <title>Список задач</title>
{% endblock %}
    
{% block content %}
    <h2>Список задач</h2>
    <ul>
        {% for task in tasks %}
            <li>
                <div class="task-header">
                    <a href="{% url 'edit_task' task.pk %}">{{ task.name }}</a>
                    <span class="task-date">{{ task.created_at|date:"d.m.Y H:i" }}</span>
                </div>
                <p>Планируется: {{ task.calculated_planned_effort }} часов</p>
                <p>Фактическое время: {{ task.calculated_actual_effort }} часов</p>
                <a href="{% url 'create_subtask' task.pk %}">Создать подзадачу</a>
                {% if not task.subtasks.exists %}
                    <a class="delete-link" href="{% url 'delete_task' task.pk %}">Удалить</a>
                {% else %}
                    <span class="note">* удалить нельзя, есть подзадачи</span>
                {% endif %}
            </li>
        {% endfor %}
    </ul>
    <a href="{% url 'create_task' %}">Создать новую задачу</a>
{% endblock %}
